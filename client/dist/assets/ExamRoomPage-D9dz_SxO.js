import{r as x,j as e,a as y,u as j}from"./index-Cu86cFuY.js";const b=({endTime:l,onExpire:i})=>{const o=(n=>n instanceof Date?n.getTime():typeof n=="string"?new Date(n).getTime():n)(l),[m,s]=x.useState(Math.max(o-Date.now(),0));x.useEffect(()=>{const n=setInterval(()=>{const h=Math.max(o-Date.now(),0);s(h),h<=0&&(clearInterval(n),i&&i())},1e3);return()=>clearInterval(n)},[o,i]);const a=Math.floor(m/1e3/60),d=Math.floor(m/1e3%60),c=n=>n.toString().padStart(2,"0");return e.jsxs("span",{className:"font-mono text-lg",children:[c(a),":",c(d)]})},w=({options:l,questionType:i,selected:r,onChange:o})=>{const m=(s,a)=>{if(i===1)o(a?[s]:[]);else{const d=a?[...r,s]:r.filter(c=>c!==s);o(d)}};return e.jsx("ul",{className:"space-y-2",children:l.map(s=>{const a=r.includes(s.id);return e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("input",{type:i===1?"radio":"checkbox",name:`question-option-${s.id}`,id:`option-${s.id}`,checked:a,onChange:d=>m(s.id,d.target.checked)}),e.jsx("label",{htmlFor:`option-${s.id}`,className:"flex-1 cursor-pointer",children:s.text})]},s.id)})})},I=({questionId:l,orderIndex:i,text:r,questionType:o,options:m=[],selectedOptions:s=[],onAnswer:a})=>{const d=n=>{a(n)},c=n=>{a(n.target.value)};return e.jsxs("article",{className:"p-4 border rounded-md bg-white shadow-sm space-y-4",children:[i!==void 0&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Question ",i]}),e.jsx("h2",{className:"font-medium text-gray-800",children:r}),o===3?e.jsx("textarea",{className:"w-full border rounded-md p-2 resize-y",rows:4,onChange:c,placeholder:"Type your answer here..."}):e.jsx(w,{options:m,questionType:o,selected:s,onChange:d})]})},T=()=>{const{examId:l}=y(),i=j(),[r,o]=x.useState(null),[m,s]=x.useState([]),[a,d]=x.useState({}),[c,n]=x.useState(!1);x.useEffect(()=>{if(!l)return;const t=parseInt(l,10),u=Date.now(),p=new Date(u+60*60*1e3);o({id:t,title:`Exam #${t}`,endTime:p}),s([{questionId:1,orderIndex:1,text:"What is 2 + 2?",questionType:1,options:[{id:1,text:"3"},{id:2,text:"4"},{id:3,text:"5"},{id:4,text:"6"}]},{questionId:2,orderIndex:2,text:"Select the prime numbers.",questionType:2,options:[{id:5,text:"2"},{id:6,text:"3"},{id:7,text:"4"},{id:8,text:"5"}]},{questionId:3,orderIndex:3,text:"Explain the significance of UTC in distributed systems.",questionType:3}])},[l]);const h=(t,u)=>{d(p=>({...p,[t]:u}))},f=async()=>{if(r){n(!0);try{await new Promise(t=>setTimeout(t,500)),console.log("Submitted answers:",a),i("/results")}finally{n(!1)}}},g=()=>{f()};return r?e.jsxs("div",{className:"max-w-5xl mx-auto p-4 space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:r.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"Time Left:"}),e.jsx(b,{endTime:r.endTime,onExpire:g})]})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),f()},className:"space-y-4",children:[m.map(t=>e.jsx(I,{questionId:t.questionId,orderIndex:t.orderIndex,text:t.text,questionType:t.questionType,options:t.options,selectedOptions:Array.isArray(a[t.questionId])?a[t.questionId]:[],onAnswer:u=>h(t.questionId,u)},t.questionId)),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",disabled:c,className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Submitting...":"Submit Exam"})})]})]}):e.jsx("p",{className:"p-4",children:"Loading exam..."})};export{T as default};
